{# API #}
{%- set props = props | default([]) -%}
{%- set _id = props.id | default(null) -%}
{%- set _inputProps = props.inputProps | default([]) -%}
{%- set _isChecked = props.isChecked | default(false) | boolprop -%}
{%- set _isDisabled = props.isDisabled | default(false) | boolprop -%}
{%- set _isItem = props.isItem | default(false) | boolprop -%}
{%- set _isLabelHidden = props.isLabelHidden | default(false) | boolprop -%}
{%- set _isRequired = props.isRequired | default(false) | boolprop -%}
{%- set _label = props.label | default(null) -%}
{%- set _unsafeLabel = props.UNSAFE_label | default(null) -%}
{%- set _message = props.message | default(null) -%}
{%- set _unsafeMessage = props.UNSAFE_message | default(null) -%}
{%- set _name = props.name | default(null) -%}
{%- set _validationState = props.validationState | default(null) -%}
{%- set _value = props.value | default(null) -%}
{%- set _helperText = props.helperText | default(null) -%}
{%- set _unsafeHelperText = props.UNSAFE_helperText | default(null) -%}

{# Class names #}
{%- set _inputClassName = _spiritClassPrefix ~ 'CheckboxField__input' -%}
{%- set _labelClassName = _spiritClassPrefix ~ 'CheckboxField__label' -%}
{%- set _labelHiddenClassName = _isLabelHidden ? _spiritClassPrefix ~ 'CheckboxField__label--hidden' : null -%}
{%- set _labelRequiredClassName = _isRequired ? _spiritClassPrefix ~ 'CheckboxField__label--required' : null -%}
{%- set _messageClassName = _spiritClassPrefix ~ 'CheckboxField__message' -%}
{%- set _rootClassName = _spiritClassPrefix ~ 'CheckboxField' -%}
{%- set _rootDisabledClassName = _isDisabled ? _spiritClassPrefix ~ 'CheckboxField--disabled' : null -%}
{%- set _rootItemClassName = _isItem ? _spiritClassPrefix ~ 'CheckboxField--item' : null -%}
{%- set _rootValidationStateClassName = _validationState ? _spiritClassPrefix ~ 'CheckboxField--' ~ _validationState : null -%}
{%- set _textClassName = _spiritClassPrefix ~ 'CheckboxField__text' -%}
{%- set _helperTextClassName = _spiritClassPrefix ~ 'CheckboxField__helperText' -%}

{# Attributes #}
{%- set _checkedAttr = _isChecked ? 'checked' : null -%}
{%- set _disabledAttr = _isDisabled ? 'disabled' : null -%}
{%- set _requiredAttr = _isRequired ? 'required' : null -%}
{%- set _valueAttr = _value ? 'value=' ~ _value : null -%}

{# Miscellaneous #}
{%- set _styleProps = useStyleProps(props) -%}
{%- set _classNames = [ _rootClassName, _rootDisabledClassName, _rootItemClassName, _rootValidationStateClassName, _styleProps.className ] -%}
{%- set _labelClassName = [ _labelClassName, _labelHiddenClassName, _labelRequiredClassName ] -%}
{%- set _mainPropsWithoutId = props | filter((value, prop) => prop is not same as('id')) -%}

{# Deprecations #}
{% if _validationState is same as('error') %}
    {% deprecated 'CheckboxField: The "error" value for "validationState" property will be removed in the next major version. Use "danger" instead.' %}
{% endif %}

<label for="{{ _id }}" {{ mainProps(_mainPropsWithoutId) }} {{ styleProp(_styleProps) }} {{ classProp(_classNames) }}>
    <input
        {{ inputProps(props, [], _inputProps) }}
        type="checkbox"
        id="{{ _id }}"
        name="{{ _name }}"
        class="{{ _inputClassName }}"
        {{ _checkedAttr }}
        {{ _disabledAttr }}
        {{ _requiredAttr }}
        {{ _valueAttr }} {# Intentionally without `raw` to prevent XSS. #}
    />
    <span class="{{ _textClassName }}">
        <span {{ classProp(_labelClassName) }}>{% if _unsafeLabel %}{{ _unsafeLabel | raw }}{% else %}{{ _label }}{% endif %}</span>
        {% if _helperText and not _unsafeHelperText %}<span class="{{ _helperTextClassName }}">{{ _helperText }}</span>{% endif %}
        {% if _unsafeHelperText %}<span class="{{ _helperTextClassName }}">{{ _unsafeHelperText | raw }}</span>{% endif %}
        {% if _message and not _unsafeMessage %}
            {%- if _message is iterable -%}
                <ul class="{{ _messageClassName }}">
                    {% for _messageItem in _message %}
                        <li>{{ _messageItem }}</li>
                    {% endfor %}
                </ul>
            {% else %}
                <span class="{{ _messageClassName }}">
                    {{ _message }}
                </span>
            {%- endif -%}
        {% endif %}
        {% if _unsafeMessage %}
            {%- if _unsafeMessage is iterable -%}
                <ul class="{{ _messageClassName }}">
                    {% for _messageItem in _unsafeMessage %}
                    <li>{{ _messageItem | raw }}</li>
                    {% endfor %}
                </ul>
            {% else %}
                <span class="{{ _messageClassName }}">
                    {{ _unsafeMessage | raw }}
                </span>
            {%- endif -%}
        {% endif %}
    </span>
</label>
